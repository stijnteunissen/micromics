<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create Barplots for Relative and Absolute Abundance — barplot • micromics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create Barplots for Relative and Absolute Abundance — barplot"><meta name="description" content="This function generates barplots for microbial data at the genus level. It supports both
relative and absolute abundance data and can include facets based on available metadata factors.
The resulting plots can be saved as PDF files, and the underlying data can be exported as
CSV and RDS files."><meta property="og:description" content="This function generates barplots for microbial data at the genus level. It supports both
relative and absolute abundance data and can include facets based on available metadata factors.
The resulting plots can be saved as PDF files, and the underlying data can be exported as
CSV and RDS files."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">micromics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stijnteunissen/micromics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create Barplots for Relative and Absolute Abundance</h1>
      <small class="dont-index">Source: <a href="https://github.com/stijnteunissen/micromics/blob/master/R/barplot.R" class="external-link"><code>R/barplot.R</code></a></small>
      <div class="d-none name"><code>barplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates barplots for microbial data at the genus level. It supports both
relative and absolute abundance data and can include facets based on available metadata factors.
The resulting plots can be saved as PDF files, and the underlying data can be exported as
CSV and RDS files.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">barplot</span><span class="op">(</span></span>
<span>  physeq <span class="op">=</span> <span class="va">rarefied_genus_psmelt</span>,</span>
<span>  ntaxa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  norm_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_matrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_by_factor <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  taxrank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phylum"</span>, <span class="st">"Class"</span>, <span class="st">"Order"</span>, <span class="st">"Family"</span>, <span class="st">"Genus"</span><span class="op">)</span>,</span>
<span>  date_factor <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-physeq">physeq<a class="anchor" aria-label="anchor" href="#arg-physeq"></a></dt>
<dd><p>A <code>phyloseq</code> object containing the microbiome data.
This is the input object that the function processes.</p></dd>


<dt id="arg-ntaxa">ntaxa<a class="anchor" aria-label="anchor" href="#arg-ntaxa"></a></dt>
<dd><p>An integer specifying the maximum number of taxa to display in the barplot. Default is 23.</p></dd>


<dt id="arg-norm-method">norm_method<a class="anchor" aria-label="anchor" href="#arg-norm-method"></a></dt>
<dd><p>A string indicating the normalization method used for absolute abundance
data. Options are <code>"fcm"</code> (flow cytometry) or <code>"qpcr"</code> (quantitative PCR).
(relative abundance only).</p></dd>


<dt id="arg-sample-matrix">sample_matrix<a class="anchor" aria-label="anchor" href="#arg-sample-matrix"></a></dt>
<dd><p>An optional matrix specifying the sample structure or metadata.</p></dd>


<dt id="arg-group-by-factor">group_by_factor<a class="anchor" aria-label="anchor" href="#arg-group-by-factor"></a></dt>
<dd><p>with this option you can separtate de barplot for factors</p></dd>


<dt id="arg-taxrank">taxrank<a class="anchor" aria-label="anchor" href="#arg-taxrank"></a></dt>
<dd><p>A character vector indicating the taxonomic levels at which to group the data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function generates and saves barplots as PDF files in the project’s <code>figures/</code> folder.
It also saves the processed data as CSV and RDS files in the corresponding <code>output_data/</code> folders.
Additionally, the function outputs the plot object for further customization if needed.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p>Relative abundance plots show proportions of taxa in each sample, with taxa having a mean
relative abundance below 1% grouped as "Other".</p></li>
<li><p>Absolute abundance plots use normalized cell equivalents (<code>norm_method = "fcm"</code> or <code>"qpcr"</code>)
to display the number of cells per mL for each taxon.</p></li>
<li><p>Facets are added based on metadata factors present in the phyloseq object.</p></li>
<li><p>Taxa labels are styled to include genus and species names, if available.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example usage</span></span></span>
<span class="r-in"><span><span class="fu">barplot</span><span class="op">(</span></span></span>
<span class="r-in"><span>  physeq <span class="op">=</span> <span class="va">rarefied_genus_psmelt</span>,</span></span>
<span class="r-in"><span>  ntaxa <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  colorset <span class="op">=</span> <span class="va">my_colors</span>,</span></span>
<span class="r-in"><span>  norm_method <span class="op">=</span> <span class="st">"fcm"</span>,</span></span>
<span class="r-in"><span>  sample_matrix <span class="op">=</span> <span class="va">sample_metadata</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in barplot(physeq = rarefied_genus_psmelt, ntaxa = 20, colorset = my_colors,     norm_method = "fcm", sample_matrix = sample_metadata):</span> unused argument (colorset = my_colors)</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stijn Teunissen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

