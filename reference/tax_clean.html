<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Clean Taxonomy Table in Phyloseq Object — tax_clean • micromics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clean Taxonomy Table in Phyloseq Object — tax_clean"><meta name="description" content="This function cleans and filters the taxonomy table within a phyloseq object.
It removes unclassified or ambiguous names, and replaces these and missing taxon names at genus level with placeholders derived from higher
taxonomic ranks. Optionally  this function filters specific taxa (e.g., Eukaryota, chloroplasts, mitochondria, and ASVs unclassified at Kingdom and Phylum levels).
The cleaned taxonomy enables taxonomic agglomeration (tax_glom form the package phyloseq) to genus level without merging unclassified taxa from diverse ancestry."><meta property="og:description" content="This function cleans and filters the taxonomy table within a phyloseq object.
It removes unclassified or ambiguous names, and replaces these and missing taxon names at genus level with placeholders derived from higher
taxonomic ranks. Optionally  this function filters specific taxa (e.g., Eukaryota, chloroplasts, mitochondria, and ASVs unclassified at Kingdom and Phylum levels).
The cleaned taxonomy enables taxonomic agglomeration (tax_glom form the package phyloseq) to genus level without merging unclassified taxa from diverse ancestry."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">micromics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stijnteunissen/micromics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Clean Taxonomy Table in Phyloseq Object</h1>
      <small class="dont-index">Source: <a href="https://github.com/stijnteunissen/micromics/blob/master/R/tax_clean.R" class="external-link"><code>R/tax_clean.R</code></a></small>
      <div class="d-none name"><code>tax_clean.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function cleans and filters the taxonomy table within a <code>phyloseq</code> object.
It removes unclassified or ambiguous names, and replaces these and missing taxon names at genus level with placeholders derived from higher
taxonomic ranks. Optionally  this function filters specific taxa (e.g., Eukaryota, chloroplasts, mitochondria, and ASVs unclassified at Kingdom and Phylum levels).
The cleaned taxonomy enables taxonomic agglomeration (<code>tax_glom</code> form the package <code>phyloseq</code>) to genus level without merging unclassified taxa from diverse ancestry.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tax_clean</span><span class="op">(</span>physeq <span class="op">=</span> <span class="va">physeq</span>, tax_filter <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-physeq">physeq<a class="anchor" aria-label="anchor" href="#arg-physeq"></a></dt>
<dd><p>A <code>phyloseq</code> object containing the microbiome data.
This is the input object that the function processes.</p></dd>


<dt id="arg-tax-filter">tax_filter<a class="anchor" aria-label="anchor" href="#arg-tax-filter"></a></dt>
<dd><p>Iindicating whether to apply additional
filtering to remove unwanted taxa (e.g., chloroplasts, mitochondria).</p><ul><li><p><code>TRUE</code>: Apply filtering to remove taxa such as Eukaryota, chloroplasts, mitochondria, and unclassified taxa.</p></li>
<li><p><code>FALSE</code>: Skip filtering; the taxonomy table will only be cleaned but no taxa will be removed.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A cleaned <code>phyloseq</code> object with ambiguous and unwanted taxa removed or replaced.
The cleaned <code>phyloseq</code> object is saved as an RDS file named <code>&lt;project_name&gt;_phyloseq_cleaned.rds</code> in the <code>output_data/rds_files/Before_cleaning_rds_files</code> directory.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs the following steps:</p><ul><li><p>Cleans the taxonomy table:</p><ul><li><p>Replaces ambiguous or placeholder taxa names (e.g., "uncultured organism") with <code>NA</code>.</p></li>
<li><p>Assigns missing taxon names based on their higher-level ranks (e.g., "Phylum of Kingdom").</p></li>
<li><p>Cleans the taxonomic ranks to remove overly nested placeholders.</p></li>
<li><p>Ensures consistent naming for <code>Kingdom</code> (e.g., replacing "d__Bacteria" with "Bacteria").</p></li>
</ul></li>
<li><p>If <code>tax_filter = TRUE</code>, filters out unwanted taxa such as:</p><ul><li><p>Chloroplasts (at <code>Class</code> or <code>Order</code> level).</p></li>
<li><p>Mitochondria (at <code>Family</code> level).</p></li>
<li><p>Unassigned taxa or taxa classified as <code>Eukaryota</code>.</p></li>
</ul></li>
<li><p>Saves the cleaned <code>phyloseq</code> object as an RDS file.</p></li>
<li><p>Logs the number of ASVs (amplicon sequence variants) removed during cleaning.</p></li>
</ul><p>The cleaned <code>phyloseq</code> object is returned for further analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Clean taxonomy table and apply filtering</span></span></span>
<span class="r-in"><span><span class="va">physeq_cleaned</span> <span class="op">&lt;-</span> <span class="fu">tax_clean</span><span class="op">(</span>physeq <span class="op">=</span> <span class="va">physeq</span>, tax_filter <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clean taxonomy table without filtering</span></span></span>
<span class="r-in"><span><span class="va">physeq_cleaned_no_filter</span> <span class="op">&lt;-</span> <span class="fu">tax_clean</span><span class="op">(</span>physeq <span class="op">=</span> <span class="va">physeq</span>, tax_filter <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stijn Teunissen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

