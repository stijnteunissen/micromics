<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Normalize Phyloseq Data — normalise_data • micromics</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Normalize Phyloseq Data — normalise_data"><meta name="description" content="This function applies normalization to a phyloseq object, converting
data to absolute values based on 16S rRNA copy numbers and sample biomass,
using either flow cytometry (FCM) data or qPCR data. The function can apply
copy number correction prior to biomass normalization."><meta property="og:description" content="This function applies normalization to a phyloseq object, converting
data to absolute values based on 16S rRNA copy numbers and sample biomass,
using either flow cytometry (FCM) data or qPCR data. The function can apply
copy number correction prior to biomass normalization."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">micromics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stijnteunissen/micromics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Normalize Phyloseq Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/stijnteunissen/micromics/blob/master/R/normalise_data.R" class="external-link"><code>R/normalise_data.R</code></a></small>
      <div class="d-none name"><code>normalise_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function applies normalization to a <code>phyloseq</code> object, converting
data to absolute values based on 16S rRNA copy numbers and sample biomass,
using either flow cytometry (FCM) data or qPCR data. The function can apply
copy number correction prior to biomass normalization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">normalise_data</span><span class="op">(</span></span>
<span>  physeq <span class="op">=</span> <span class="va">without_mock_physeq</span>,</span>
<span>  norm_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  copy_correction <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-physeq">physeq<a class="anchor" aria-label="anchor" href="#arg-physeq"></a></dt>
<dd><p>A <code>phyloseq</code> object containing the microbiome data.
This is the input object that the function processes.</p></dd>


<dt id="arg-norm-method">norm_method<a class="anchor" aria-label="anchor" href="#arg-norm-method"></a></dt>
<dd><p>A character string specifying the normalization method. Options are:</p><ul><li><p><code>"fcm"</code>: Normalize based on flow cytometry data, converting abundances to cell concentrations (cells/mL or per gram sample).</p></li>
<li><p><code>"qpcr"</code>: Normalize based on qPCR data, converting abundances to cell equivalents (cells/mL or per gram sample).</p></li>
<li><p><code>NULL</code>: Apply only copy number correction without further normalization.</p></li>
</ul></dd>


<dt id="arg-copy-correction">copy_correction<a class="anchor" aria-label="anchor" href="#arg-copy-correction"></a></dt>
<dd><p>A logical value indicating whether the data should be corrected for
the predicted 16S rRNA copy numbers prior to biomass normalization. Options are:</p><ul><li><p><code>TRUE</code>: Both relative and absolute abundances are corrected using the predicted copy numbers.</p></li>
<li><p><code>FALSE</code>: Abundances are not corrected by copy number. Note that qPCR normalization requires
copy number correction to provide absolute data.</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function saves multiple <code>phyloseq</code> objects as RDS files:</p><ul><li><p><code>&lt;project_name&gt;_phyloseq_asv_level_without_copy_number_corrected_counts.rds</code>: if <code>copy_correction = FALSE</code>;
a phyloseq object with uncorrected counts.</p></li>
<li><p><code>&lt;project_name&gt;_phyloseq_asv_level_copy_number_corrected_counts.rds</code>: if <code>copy_correction = TRUE</code>;
a phyloseq object with counts corrected by predicted 16S copy numbers.</p></li>
<li><p><code>&lt;project_name&gt;_phyloseq_asv_level_fcm_normalised_cell_concentration.rds</code>: if <code>norm_method = "fcm"</code> and <code>copy_correction = TRUE</code>;
a phyloseq object with abundances normalized based on FCM data and copy number correction.</p></li>
<li><p><code>&lt;project_name&gt;_phyloseq_asv_level_fcm_normalised_cell_concentration_without_copy_number_corrected_count.rds</code>: if <code>norm_method = "fcm"</code> and <code>copy_correction = FALSE</code>;
a phyloseq object with FCM normalization applied without copy number correction.</p></li>
<li><p><code>&lt;project_name&gt;_phyloseq_asv_level_qpcr_normalised_cell_concentration.rds</code>: if <code>norm_method = "qpcr"</code>;
a phyloseq object with abundances normalized to cell equivalents using qPCR data.</p></li>
</ul><p>The relative phyloseq object (without biomass normalization) is saved in the
<code>output_data/rds_files/After_cleaning_rds_files/ASV</code> directory, and all biomass-normalized
phyloseq objects are saved in the <code>output_data/rds_files/Before_cleaning_rds_files</code> directory.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function follows these steps based on the chosen parameters:</p><ol><li><p><strong>Copy Number Correction (if <code>copy_correction = TRUE</code>):</strong></p><ul><li><p>Correct ASV abundances by dividing each count by its predicted 16S rRNA copy number.
The prediction is based on the method described in
<a href="https://dx.doi.org/10.1038/s43705-023-00266-0" class="external-link">"Accounting for 16S rRNA copy number prediction uncertainty and its implications in bacterial diversity analyses"</a>.</p></li>
<li><p>This correction adjusts for variability in 16S rRNA gene copy numbers across taxa, enabling
the calculation of cell equivalents.</p></li>
</ul></li>
<li><p><strong>FCM Normalization (<code>norm_method = "fcm"</code>):</strong></p><ul><li><p>When <code>copy_correction = TRUE</code>: The copy number–corrected abundances are multiplied by the FCM data,
where FCM data (cells per mL or per gram) is included in the metadata or a file with "fcm" in the name,
with the column <code>cells_per_ml</code>.</p></li>
<li><p>When <code>copy_correction = FALSE</code>: The raw abundances are multiplied by the FCM data without prior copy number correction.</p></li>
</ul></li>
<li><p><strong>qPCR Normalization (<code>norm_method = "qpcr"</code>):</strong></p><ul><li><p>The qPCR data, provided in 16S copies per mL or per gram sample (included in the metadata or
a file with "qpcr" in the name and column <code>sq_calc_mean</code>), is used together with copy number
predictions to calculate absolute abundances.</p></li>
</ul></li>
</ol><div class="section">
<h3 id="dna-vs-rna-normalization">DNA vs. RNA Normalization<a class="anchor" aria-label="anchor" href="#dna-vs-rna-normalization"></a></h3>


<p>The interpretation of normalized data depends on the nucleic acid type:</p><ul><li><p><strong>DNA:</strong> Normalized abundances usually represent <strong>cells per mL (or per gram)</strong>, assuming one genome copy per cell.</p></li>
<li><p><strong>RNA:</strong> Normalized abundances often represent <strong>copies per cell equivalent per mL (or per gram)</strong>;
RNA reflects transcriptional activity and may vary considerably with cell condition.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gao, Y., &amp; Wu, M. (2023). Accounting for 16S rRNA copy number prediction uncertainty
and its implications in bacterial diversity analyses. <em>ISME Communications, 3</em>(1), 59.
doi:<a href="https://dx.doi.org/10.1038/s43705-023-00266-0" class="external-link">10.1038/s43705-023-00266-0</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Apply only copy number correction</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">normalize_data</span><span class="op">(</span>physeq <span class="op">=</span> <span class="va">physeq</span>, norm_method <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Normalize using flow cytometry (FCM) data</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">normalize_data</span><span class="op">(</span>physeq <span class="op">=</span> <span class="va">physeq</span>, norm_method <span class="op">=</span> <span class="st">"fcm"</span>, copy_correction <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Normalize using qPCR data</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">normalize_data</span><span class="op">(</span>physeq <span class="op">=</span> <span class="va">physeq</span>, norm_method <span class="op">=</span> <span class="st">"qpcr"</span>, copy_correction <span class="op">=</span> <span class="va">TURE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stijn Teunissen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

